<!DOCTYPE html>
<html>



<head>
	<title>Ozy</title>
</head>



<style type="text/css">
	table, th, td {
		text-align: left;
		border: 1px solid rgba(30,20,25,.15);
	}

	th {
		padding-right: 5px;
		font-size: 1.2em;
		background-color: rgba(30,20,25,.15);
	}

	td {
		padding-right: 5px;
		font-size: 1em
	}
</style>



<body>
	<table>
		<tr>
			<th>Fields</th>
			<th>Info</th>
		</tr>
		<tr>
			<td><strong>Name</strong></td>
			<td><span id="name"></span></td>
		</tr>
		<tr>
			<td><strong>Alignment</strong></td>
			<td><span id="alignment"></span></td>
		</tr>
		<tr>
			<td><strong>Level</strong></td>
			<td><span id="level"></span></td>
		</tr>
		<tr>
			<td><strong>Diety</strong></td>
			<td><span id="diety"></span></td>
		</tr>
		<tr>
			<td><strong>Homeland</strong></td>
			<td><span id="homeland"></span></td>
		</tr>
		<tr>
			<td><strong>Race</strong></td>
			<td><span id="race"></span></td>
		</tr>
		<tr>
			<td><strong>Size</strong></td>
			<td><span id="size"></span></td>
		</tr>
		<tr>
			<td><strong>Gender</strong></td>
			<td><span id="gender"></span></td>
		</tr>
		<tr>
			<td><strong>Age</strong></td>
			<td><span id="age"></span></td>
		</tr>
		<tr>
			<td><strong>Height</strong></td>
			<td><span id="height"></span></td>
		</tr>
		<tr>
			<td><strong>Weight</strong></td>
			<td><span id="weight"></span></td>
		</tr>
		<tr>
			<td><strong>Hair</strong></td>
			<td><span id="hair"></span></td>
		</tr>
		<tr>
			<td><strong>Eyes</strong></td>
			<td><span id="eyes"></span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<tr>
			<th>Name</th>
			<th>Score</th>
			<th>Modifier</th>
		</tr>
		<tr>
			<td><strong>[STR] (strength)</strong></td>
			<td><span id="str">0</span></td>
			<td><span id="str-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[DEX] (dexterity)</strong></td>
			<td><span id="dex">0</span></td>
			<td><span id="dex-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[CON] (constitution)</strong></td>
			<td><span id="con">0</span></td>
			<td><span id="con-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[INT] (intelligence)</strong></td>
			<td><span id="int">0</span></td>
			<td><span id="int-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[WIS] (wisdom)</strong></td>
			<td><span id="wis">0</span></td>
			<td><span id="wis-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[CHA] (charisma)</strong></td>
			<td><span id="cha">0</span></td>
			<td><span id="cha-mod">0</span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<tr>
			<th>Platinum</th>
			<th>Gold</th>
			<th>Silver</th>
			<th>Copper</th>
		</tr>
		<tr>
			<td><span id="platinum">0</span></td>
			<td><span id="gold">0</span></td>
			<td><span id="silver">0</span></td>
			<td><span id="copper">0</span></td>
		</tr>
	</table>
	<hr/>
	<span id="table-equipment"></span>
	<hr/>
	<span id="table-weapons"></span>
	<hr/>
	<span id="table-items"></span>
	<hr/>
</body>



<script type="text/javascript">
	p = {};
	
	p.name = "-";
	p.alignment = "-";
	p.level = -1;
	p.diety = "-";
	p.homeland = "-";
	p.race = "-";
	p.size = "-";
	p.gender = "-";  
	p.age = -1;      // In years
	p.height = -1;   // In inches
	p.weight = -1;   // In pounds
	p.hair = "-";
	p.eyes = "-";

	p.str = -1;
	p.dex = -1;
	p.con = -1;
	p.int = -1;
	p.wis = -1;
	p.cha = -1;

	p.speed = -1;
	p.hp = -1;

	p.equipment = [];
	p.weapons = [];
	p.items = [];

	function readGeneral() {
		p.name = "Ozymandias";
		p.alignment = "True Neutral";
		p.level = 13;
		p.diety = "None";
		p.homeland = "Menachterun, Xen-drik";
		p.race = "Tiefling";
		p.size = "M";
		p.gender = "M";
		p.age = "Unknown";
		p.height = "68";
		p.weight = "220"; // tail adds weight
		p.hair = "Messy brown with horns"
		p.eyes = "Grey";
	}

	function readAbilites() {
		p.str = 9;
		p.dex = 16;
		p.con = 12;
		p.int = 12;
		p.wis = 10
		p.cha = 26;
	} 

	function readWeapons() {
		p.weapons = [
			{name:"+2 Ghostly Scimitar", stats:"damage_+2", type:"scimitar", weight: "5", effects:"ghost touch", damage:"1d6", notes:"bab+dex+1, critical 18-20 (2x)"},
		];
	}

	function readEquipment() {
		p.equipment = [
			{name:"Chainshirt", stats:"ac_+5 stealth_-1", type:"shirt", weight:"20", equipped:true, value:100},
			{name:"Ring of Protection", stats:"ac_+1", type:"ring", weight:"0", equipped:true, value:100},
			{name:"Boots of Stridening", stats:"speed_+10", type:"boots", weight:"1", equipped:true, value:100},
			{name:"Stealth Cloak", stats:"stealth_+1", type:"cloak", weight:"3", equipped:true, value:100},
			{name:"Stylish Headband", stats:"cha_+2", type:"shirt", weight:"0", equipped:true, value:100},
			{name:"Amulet of Natural Armor", stats:"ac_+1", type:"amulet", weight:"0", equipped:true, value:100},
		];
	}

	function readItems() {
		p.items = [
			{name:"Commoner clothes", weight: "2", value:"1", notes:"A couple beige and generic looking clothes. Clean, but they don't stand out."},
		];
	}


////////////////////////////
// Display various things //
////////////////////////////


	function showGeneral() {
		getId('name').innerHTML = p.name;
		getId('alignment').innerHTML = p.alignment;
		getId('level').innerHTML = p.level;
		getId('diety').innerHTML = p.diety;
		getId('homeland').innerHTML = p.homeland;
		getId('race').innerHTML = p.race;
		getId('size').innerHTML = p.size;
		getId('gender').innerHTML = p.gender;
		getId('age').innerHTML = p.age;
		getId('height').innerHTML = p.height;
		getId('weight').innerHTML = p.weight;
		getId('hair').innerHTML = p.hair;
		getId('eyes').innerHTML = p.eyes;
	}

	function showAbilities() {
		getId('str').innerHTML = p.str;
		getId('dex').innerHTML = p.dex;
		getId('con').innerHTML = p.con;
		getId('int').innerHTML = p.int;
		getId('wis').innerHTML = p.wis;
		getId('cha').innerHTML = p.cha;
	}

	function showEquipment() {
		let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Name</th>
				<th>Stats</th>
				<th>Type</th>
				<th>Weight</th>
				<th>Equipped</th>
				<th>Value (gp)</th>
			</tr>`;

		for(let i = 0; i < p.equipment.length; i++) {
			let item = p.equipment[i];

			built += `
				<tr>
					<td>${item.name}</td>
					<td>${item.stats.split(' ').join(', ').split('_').join(' ')}</td>
					<td>${item.type}</td>
					<td>${item.weight}</td>
					<td>${item.equipped}</td>
					<td>${item.value}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-equipment').innerHTML = built;
	}

 	function showWeapons() {
		let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Name</th>
				<th>Stats</th>
				<th>Type</th>
				<th>Weight</th>
				<th>Effects</th>
				<th>Damage</th>
				<th>Notes</th>
			</tr>`;

		for(let i = 0; i < p.weapons.length; i++) {
			let item = p.weapons[i];

			built += `
				<tr>
					<td>${item.name}</td>
					<td>${item.stats.split(' ').join(', ').split('_').join(' ')}</td>
					<td>${item.type}</td>
					<td>${item.weight}</td>
					<td>${item.effects}</td>
					<td>${item.damage}</td>
					<td>${item.notes}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-weapons').innerHTML = built;
	}

	function showItems() {
			let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Name</th>
				<th>Weight</th>
				<th>Value (gp)</th>
				<th>Notes</th>
			</tr>`;

		for(let i = 0; i < p.items.length; i++) {
			let item = p.items[i];

			built += `
				<tr>
					<td>${item.name}</td>
					<td>${item.weight}</td>
					<td>${item.value}</td>
					<td>${item.notes}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-items').innerHTML = built;
	}
//////////////////////////////
// Calculate various things //
//////////////////////////////


	function calculateAbilityModifiers() {
		function calc_am(a) {
			return Math.floor((a - 10) / 2);
		}

		getId('str-mod').innerHTML = calc_am(p.str);
		getId('dex-mod').innerHTML = calc_am(p.dex);
		getId('con-mod').innerHTML = calc_am(p.con);
		getId('int-mod').innerHTML = calc_am(p.int);
		getId('wis-mod').innerHTML = calc_am(p.wis);
		getId('cha-mod').innerHTML = calc_am(p.cha);
	}

	// Split on spaces and then on underscores. Note that stats are in the format (stat1_+2 stat2_-50)
	function calculateEquipmentModifiers() {

		for (let i = 0; i < p.equipment.length; i++) { 
  			let item = p.equipment[i];
  			
  			if(!item.equipped) {
  				continue;
  			}

  			let stats = item.stats.split(' ');

  			for(let j = 0; j < stats.length; j++) {
  				let split = stats[j].split('_');
  				let stat = split[0];
  				let change = parseInt(split[1]);
				
  				p[stat] = p[stat] + change;
  			}
		}
	}


///////////////////////
// Utility Functions //
///////////////////////


	function getId(id) {
		return document.getElementById(id);
	}



//////////////////////
// Run Applications //
//////////////////////


	function refreshAll() {
		readGeneral();
		readAbilites();
		readWeapons();
		readEquipment();
		readItems();

		calculateEquipmentModifiers();
		calculateAbilityModifiers();

		showGeneral();
		showAbilities();
		showEquipment();
		showWeapons();
		showItems();
	}

	refreshAll();
</script>
</html>