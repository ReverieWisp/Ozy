<!DOCTYPE html>
<html>



<head>
	<title>Ozymandias</title>
</head>



<style type="text/css">
	table, th, td {
		text-align: left;
		border: 1px solid rgba(30,20,25,.15);
	}

	th {
		padding-right: 5px;
		font-size: 1.2em;
		background-color: rgba(30,20,25,.15);
	}

	td {
		padding-right: 5px;
		font-size: 1em
	}
</style>



<body>
	<h1>Character Sheet</h1>
	<hr/>
	<table>
		<h2>General</h2>
		<tr>
			<th>Fields</th>
			<th>Info</th>
		</tr>
		<tr>
			<td><strong>Name</strong></td>
			<td><span id="name"></span></td>
		</tr>
		<tr>
			<td><strong>Alignment</strong></td>
			<td><span id="alignment"></span></td>
		</tr>
		<tr>
			<td><strong>Level</strong></td>
			<td><span id="level"></span></td>
		</tr>
		<tr>
			<td><strong>Diety</strong></td>
			<td><span id="diety"></span></td>
		</tr>
		<tr>
			<td><strong>Homeland</strong></td>
			<td><span id="homeland"></span></td>
		</tr>
		<tr>
			<td><strong>Race</strong></td>
			<td><span id="race"></span></td>
		</tr>
		<tr>
			<td><strong>Size</strong></td>
			<td><span id="size"></span></td>
		</tr>
		<tr>
			<td><strong>Gender</strong></td>
			<td><span id="gender"></span></td>
		</tr>
		<tr>
			<td><strong>Age</strong></td>
			<td><span id="age"></span></td>
		</tr>
		<tr>
			<td><strong>Height</strong></td>
			<td><span id="height"></span></td>
		</tr>
		<tr>
			<td><strong>Weight</strong></td>
			<td><span id="weight"></span></td>
		</tr>
		<tr>
			<td><strong>Hair</strong></td>
			<td><span id="hair"></span></td>
		</tr>
		<tr>
			<td><strong>Eyes</strong></td>
			<td><span id="eyes"></span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<h2>Abilities</h2>
		<tr>
			<th>Name</th>
			<th>Score</th>
			<th>Modifier</th>
		</tr>
		<tr>
			<td><strong>[STR] (strength)</strong></td>
			<td><span id="str">0</span></td>
			<td><span id="str-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[DEX] (dexterity)</strong></td>
			<td><span id="dex">0</span></td>
			<td><span id="dex-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[CON] (constitution)</strong></td>
			<td><span id="con">0</span></td>
			<td><span id="con-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[INT] (intelligence)</strong></td>
			<td><span id="int">0</span></td>
			<td><span id="int-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[WIS] (wisdom)</strong></td>
			<td><span id="wis">0</span></td>
			<td><span id="wis-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>[CHA] (charisma)</strong></td>
			<td><span id="cha">0</span></td>
			<td><span id="cha-mod">0</span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<h2>Initiative</h2>
		<tr>
			<th>Total</th>
			<th>Dex Mod</th>
			<th>Misc</th>
		</tr>
		<tr>
			<td><span id="initiative">0</span></td>
			<td><span id="initiative-mod">0</span></td>
			<td><span id="initiative-misc">0</span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<h2>Armor Class</h2>
	</table>
	<hr/>
	<table>
		<h2>Saves</h2>
		<tr>
			<th>Save</th>
			<th>Total</th>
			<th>Base</th>
			<th>Modifier</th>
		</tr>
		<tr>
			<td><strong>Fortitude (con)</strong></td>
			<td><span id="fortitude">0</span></td>
			<td><span id="fortitudeBase">0</span></td>
			<td><span id="fortitude-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>Reflex (dex)</strong></td>
			<td><span id="reflex">0</span></td>
			<td><span id="reflexBase">0</span></td>
			<td><span id="reflex-mod">0</span></td>
		</tr>
		<tr>
			<td><strong>Will (wis)</strong></td>
			<td><span id="will">0</span></td>
			<td><span id="willBase">0</span></td>
			<td><span id="will-mod">0</span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<h2>Combat</h2>
	</table>
	<hr/>
	<table>
		<h2>Health</h2>
		<tr>
			<th>Total HP</th>
			<th>Current HP</th>
		</tr>
		<tr>
			<td><span id="healthBase">0</span></td>
			<td><span id="health">0</span></td>
		</tr>
	</table>
	<hr/>
	<table>
		<h2>Movement</h2>
		<tr>
			<th>Base Speed</th>
			<th>Current Speed</th>
		</tr>
		<tr>
			<td><span id="speedBase">0</span></td>
			<td><span id="speed">0</span></td>
		</tr>		
	</table>
	<hr/>
	<table>
		<h2>Money</h2>
		<tr>
			<th>Platinum</th>
			<th>Gold</th>
			<th>Silver</th>
			<th>Copper</th>
		</tr>
		<tr>
			<td><span id="platinum">0</span></td>
			<td><span id="gold">0</span></td>
			<td><span id="silver">0</span></td>
			<td><span id="copper">0</span></td>
		</tr>
	</table>
	<hr/>
	<h2>Equipment</h2>
	<span id="table-equipment"></span>
	<hr/>
	<h2>Weapons</h2>
	<span id="table-weapons"></span>
	<hr/>
	<h2>Items</h2>
	<span id="table-items"></span>
	<hr/>
	<h2>Langauges</h2>
	<span id="table-langauges"></span>
</body>



<script type="text/javascript">
	p = {};
	
	// General
	p.name = "-";
	p.alignment = "-";
	p.level = -1;
	p.diety = "-";
	p.homeland = "-";
	p.race = "-";
	p.size = "-";
	p.gender = "-";  
	p.age = -1;      // In years
	p.height = -1;   // In inches
	p.weight = -1;   // In pounds
	p.hair = "-";
	p.eyes = "-";

	// Abilities
	p.str = -1;
	p.dex = -1;
	p.con = -1;
	p.int = -1;
	p.wis = -1;
	p.cha = -1;

	// Combat
	p.initiative = -1;
	p.ac = -1;
	p.acTouch = -1;
	p.acFlat = -1;
	p.bab = -1;
	p.cmb = -1;
	p.cmd = -1;

	// Health
	p.health = -1;     // This is the current health
	p.healthBase = -1; // This is the base health

	// Movement
	p.speed = -1;     // This is the current speed
	p.speedBase = -1; // This is the base speed

	// Saves
	p.fortitudeBase = -1;
	p.fortitude = -1;
	p.reflexBase = -1;
	p.reflex = -1;
	p.willBase = -1;
	p.will = -1;

	// Money
	p.platinum = -1;
	p.gold = -1;
	p.silver = -1;
	p.copper = -1;

	// Collections of things
	p.equipment = [];
	p.weapons = [];
	p.items = [];
	p.languages = [];

	function readGeneral() {
		p.name = "Ozymandias";
		p.alignment = "True Neutral";
		p.level = 13;
		p.diety = "None";
		p.homeland = "Menachterun, Xen-drik";
		p.race = "Tiefling";
		p.size = "M";
		p.gender = "M";
		p.age = "Unknown";
		p.height = "68";
		p.weight = "220"; // tail adds weight
		p.hair = "Messy brown with horns"
		p.eyes = "Grey";
	}

	function readAbilites() {
		p.str = 9;
		p.dex = 16;
		p.con = 12;
		p.int = 12;
		p.wis = 10
		p.cha = 26;
	} 

	function readSpeed() {
		p.speedBase = 30;
	}

	function readHealth() {
		p.healthBase = 85;
	}

	function readSaves() {
		p.fortitudeBase = 3;
		p.reflexBase = 7;
		p.willBase = 7;
	}

	function readMoney() {
		p.platinum = 1;
		p.gold = 2;
		p.silver = 3;
		p.copper = 4;
	}

	function readWeapons() {
		p.weapons = [
			{name:"+2 Ghostly Scimitar", stats:"damage_+2", type:"scimitar", weight: "5", effects:"ghost touch", damage:"1d6", notes:"bab+dex+1, critical 18-20 (2x)", value:100},
		];
	}

	function readEquipment() {
		p.equipment = [
			{name:"Chainshirt", stats:"ac_+5 stealth_-1", type:"shirt", weight:"20", equipped:true, value:100, notes:""},
			{name:"Ring of Protection", stats:"ac_+1", type:"ring", weight:"0", equipped:true, value:100, notes:""},
			{name:"Boots of Stridening", stats:"speed_+10", type:"boots", weight:"1", equipped:true, value:100, notes:""},
			{name:"Stealth Cloak", stats:"stealth_+1", type:"cloak", weight:"3", equipped:true, value:100, notes:""},
			{name:"Stylish Headband", stats:"cha_+2", type:"shirt", weight:"0", equipped:true, value:100, notes:""},
			{name:"Amulet of Natural Armor", stats:"ac_+1", type:"amulet", weight:"0", equipped:true, value:100, notes:""},
		];
	}

	function readItems() {
		p.items = [
			{name:"Commoner clothes", weight: "2", value:"1", notes:"A couple beige and generic looking clothes. Clean, but they don't stand out."},
		];
	}

	function readLanguages() {
		p.languages = [
			{name:"Common", notes:"General language"},
			{name:"Undercommon", notes:"Lower-class language"},
			{name:"Brellish", notes:""},
			{name:"Sylvan", notes:""},
			{name:"Dragonic", notes:"Language of Dragons"},
			{name:"Abyssal", notes:"Language of Demons"},
			{name:"Infernal", notes:"Laguage of Devils"},
		];
	}


//////////////////////////////
// Calculate various things //
//////////////////////////////


	// Calculate ability modifiers based on existing things
	function calculateAbilityModifiers() {
		getId('str-mod').innerHTML = calcAbilityMod(p.str);
		getId('dex-mod').innerHTML = calcAbilityMod(p.dex);
		getId('con-mod').innerHTML = calcAbilityMod(p.con);
		getId('int-mod').innerHTML = calcAbilityMod(p.int);
		getId('wis-mod').innerHTML = calcAbilityMod(p.wis);
		getId('cha-mod').innerHTML = calcAbilityMod(p.cha);
	}

	// Split on spaces and then on underscores. Note that stats are in the format (stat1_+2 stat2_-50)
	function calculateEquipmentModifiers() {
		for (let i = 0; i < p.equipment.length; i++) { 
  			let item = p.equipment[i];
  			
  			if(!item.equipped) {
  				continue;
  			}

  			let stats = item.stats.split(' ');

  			for(let j = 0; j < stats.length; j++) {
  				let split = stats[j].split('_');
  				let stat = split[0];
  				let change = parseInt(split[1]);
				
  				p[stat] = p[stat] + change;
  			}
		}
	}

	function calculateHealth() {
		p.health = p.healthBase;
	}

	function calculateSpeed() {
		p.speed = p.speedBase;
	}

	function calculateSaves() {
		p.fortitude = p.fortitudeBase + calcAbilityMod(p.con);
		p.reflex = p.reflexBase + calcAbilityMod(p.dex);
		p.will = p.willBase + calcAbilityMod(p.wis);
	}

	function calculateInitiative() {
		p.initiative = calcAbilityMod(p.dex);
	}
	

////////////////////////////
// Display various things //
////////////////////////////


	function showGeneral() {
		showById('name');
		showById('alignment');
		showById('level');
		showById('diety');
		showById('homeland');
		showById('race');
		showById('size');
		showById('gender');
		showById('age');
		showById('height');
		showById('weight');
		showById('hair');
		showById('eyes');

		showById('str');
		showById('dex');
		showById('con');
		showById('int');
		showById('wis');
		showById('cha');

		showById('speedBase');
		showById('speed');

		showById('healthBase');
		showById('health');

		showById('platinum');
		showById('gold');
		showById('silver');
		showById('copper');
	}

	function showEquipment() {
		let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Name</th>
				<th>Stats</th>
				<th>Type</th>
				<th>Weight</th>
				<th>Equipped</th>
				<th>Value (gp)</th>
				<th>Notes</th>
			</tr>`;

		for(let i = 0; i < p.equipment.length; i++) {
			let item = p.equipment[i];

			built += `
				<tr>
					<td>${item.name}</td>
					<td>${item.stats.split(' ').join(', ').split('_').join(' ')}</td>
					<td>${item.type}</td>
					<td>${item.weight}</td>
					<td>${item.equipped}</td>
					<td>${item.value}</td>
					<td>${item.notes}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-equipment').innerHTML = built;
	}

 	function showWeapons() {
		let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Name</th>
				<th>Stats</th>
				<th>Type</th>
				<th>Weight</th>
				<th>Effects</th>
				<th>Damage</th>
				<th>Value (gp)</th>
				<th>Notes</th>
			</tr>`;

		for(let i = 0; i < p.weapons.length; i++) {
			let item = p.weapons[i];

			built += `
				<tr>
					<td>${item.name}</td>
					<td>${item.stats.split(' ').join(', ').split('_').join(' ')}</td>
					<td>${item.type}</td>
					<td>${item.weight}</td>
					<td>${item.effects}</td>
					<td>${item.damage}</td>
					<td>${item.value}</td>
					<td>${item.notes}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-weapons').innerHTML = built;
	}

	function showItems() {
		let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Name</th>
				<th>Weight</th>
				<th>Value (gp)</th>
				<th>Notes</th>
			</tr>`;

		for(let i = 0; i < p.items.length; i++) {
			let item = p.items[i];

			built += `
				<tr>
					<td>${item.name}</td>
					<td>${item.weight}</td>
					<td>${item.value}</td>
					<td>${item.notes}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-items').innerHTML = built;
	}

	function showLanguages() {
		let built = "";
		built += '<table>';
		built += `
			<tr>
				<th>Language</th>
				<th>Notes</th>
			</tr>`;

		for(let i = 0; i < p.languages.length; i++) {
			let language = p.languages[i];

			built += `
				<tr>
					<td>${language.name}</td>
					<td>${language.notes}</td>
				</tr>`;
		}

		built += '</table>';
		getId('table-langauges').innerHTML = built;
	}

	function showSaves() {
		showById('fortitude');
		showById('fortitudeBase');
		getId('fortitude-mod').innerHTML = calcAbilityMod(p.con);

		showById('reflex');
		showById('reflexBase');
		getId('reflex-mod').innerHTML = calcAbilityMod(p.dex);

		showById('will');
		showById('willBase');
		getId('will-mod').innerHTML = calcAbilityMod(p.wis);
	}

	function showInitiative() {
		showById('initiative');
		getId('initiative-mod').innerHTML = calcAbilityMod(p.dex);
		getId('initiative-misc').innerHTML = 0;
	}

///////////////////////
// Utility Functions //
///////////////////////


	function calcAbilityMod(a) {
		return Math.floor((a - 10) / 2);
	}

	function getId(id){
		return document.getElementById(id);
	}

	function showById(id){
		getId(id).innerHTML = p[id];
	}


//////////////////////
// Run Applications //
//////////////////////

	function refreshAll() {
		readGeneral();
		readAbilites();
		readEquipment();
		readWeapons();
		readItems();
		readHealth();
		readSpeed();
		readSaves();
		readLanguages();
		readMoney();

		calculateHealth();
		calculateSpeed();
		calculateEquipmentModifiers();
		calculateAbilityModifiers();
		calculateSaves();
		calculateInitiative();

		showGeneral();
		showEquipment();
		showWeapons();
		showItems();
		showLanguages();
		showSaves();
		showInitiative();
	}

	refreshAll();
</script>
</html>